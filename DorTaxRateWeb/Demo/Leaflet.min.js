(function(n){"use strict";function o(n){n||(n=new Date(Date.now()));this.year=n.getFullYear();this.quarter=Math.ceil((n.getMonth()+1)/3)}function s(n){var f=n.properties,e=document.createElement("table"),o=document.createElement("tbody"),u,t,i,s,h,r;return e.appendChild(o),s=/((Local)|(Rate)|(State)|(Rta))/i,h=["Name","Rate","LocationCode","State","Local","Rta","ExpirationDate","EffectiveDate"],h.forEach(function(n){f.hasOwnProperty(n)&&(u=document.createElement("tr"),t=document.createElement("th"),t.textContent=n,u.appendChild(t),t=document.createElement("td"),i=f[n],typeof i=="number"?(r=document.createElement("data"),r.setAttribute("value",i),s.test(n)&&(r.textContent=[Math.round(i*1e3)/10,"%"].join("")),t.appendChild(r)):i instanceof Date?(r=document.createElement("dataElement"),r.setAttribute("datetime",i.toISOString()),r.textContent=i.toISOString().replace(/T.+$/,""),t.appendChild(r)):t.textContent=i,u.appendChild(t),o.appendChild(u))}),e}var t,u,f,e,i,r;t=n.map("map").setView([47.413220330159461,-120.80566406246835],7);f=n.tileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="//openstreetmap.org">OpenStreetMap<\/a> contributors, <a href="//creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA<\/a>',maxZoom:18}).addTo(t);e=n.control.layers({OpenStreetMap:f}).addTo(t);n.control.scale().addTo(t);i=new XMLHttpRequest;r=new o;i.open("GET",["../tax/boundaries/rates",r.year,r.quarter,"4326"].join("/"));i.setRequestHeader("Accept","application/vnd.geo+json,application/json,text/json");i.addEventListener("loadend",function(){var i=this.responseText,r=document.getElementsByTagName("progress")[0];r.parentElement.removeChild(r);i=JSON.parse(i,function(n,t){return/Date$/.test(n)?new Date(t):t});u=n.geoJson(i,{onEachFeature:function(n,t){t.bindPopup(s(n))}}).addTo(t);e.addOverlay(u,"Sales Tax Boundaries")});i.send()})(L);